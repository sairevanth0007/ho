<html>
<head>
</head>
<body style="background: transparent;">
    <script src="scripts/docstrap.lib.js"></script>
    <script src="scripts/lunr.min.js"></script>
    <script src="scripts/fulltext-search.js"></script>

    <script type="text/x-docstrap-searchdb">
    {"global.html":{"id":"global.html","title":"Global","body":" My Backend API Docs Classes ApiErrorApiResponse Global STRIPE_PLAN_PRICE_IDSSTRIPE_WEBHOOK_SECRETasyncHandlerconnectDBcreateCheckoutSessioncreateRateLimitererrorHandlergetCurrentUserhandleOAuthFailurehandleOAuthSuccesshandleStripeWebhookisAuthenticatedlogoutUsermanageSubscriptionPortalrateLimiterstripeupgradeToYearlyvalidatevalidatePlanIdSchemavalidateReferralCodeSchema Global Members &lt;constant&gt; STRIPE_PLAN_PRICE_IDS :object Stores the Stripe Price IDs for monthly and yearly plans. These IDs must be created in your Stripe Dashboard. Type: object &lt;constant&gt; STRIPE_WEBHOOK_SECRET :string Webhook signing secret for verifying Stripe webhook events. Type: string &lt;constant&gt; rateLimiter General purpose rate limiter for all API routes. It limits each IP to `maxRequests` requests per `windowMs`. See: https://www.npmjs.com/package/express-rate-limit for more configuration options. &lt;constant&gt; stripe :Stripe Stripe API client instance. Type: Stripe &lt;constant&gt; validatePlanIdSchema Joi schema for validating a MongoDB ObjectId as a planId. &lt;constant&gt; validateReferralCodeSchema Joi schema for validating a referral code input. This might be used if a user can manually enter a referral code post-signup or during. Methods asyncHandler(requestHandler) Wraps an asynchronous request handler function to automatically catch errors and pass them to the next error-handling middleware. Parameters: Name Type Description requestHandler function The asynchronous route handler function. Returns: A new function that handles promise resolution and rejection. Type function Example import { asyncHandler } from \"../utils/asyncHandler.js\"; router.get(\"/some-route\", asyncHandler(async (req, res, next) =&gt; { // Your async logic here const data = await someAsyncOperation(); res.status(200).json(new ApiResponse(200, data, \"Data fetched\")); })); &lt;async&gt; connectDB() Establishes a connection to the MongoDB database. It uses the MONGODB_URI from environment variables and specifies the database name. Exits the process with failure code 1 if connection fails. Returns: A promise that resolves when the connection is successful. Type Promise.&lt;void&gt; &lt;async&gt; createCheckoutSession(req, res, next) Creates a Stripe Checkout Session for a new subscription. Parameters: Name Type Description req Express.Request Express request object. res Express.Response Express response object. next Express.NextFunction Express next middleware function. createRateLimiter(customWindowMs, customMaxRequests [, customMessage]) Creates a custom rate limiter with specific options. This allows for different rate limits on different routes if needed. Parameters: Name Type Argument Default Description customWindowMs number The time window in milliseconds. customMaxRequests number The maximum number of requests allowed in the window. customMessage string &lt;optional&gt; \"Too many requests, please try again later.\" Custom message for rate-limited responses. Returns: Express rate limit middleware instance. Type function Example // In your route file: // import { createRateLimiter } from '../middlewares/rateLimiter.middleware.js'; // const loginRateLimiter = createRateLimiter(5 * 60 * 1000, 5, \"Too many login attempts. Please try again in 5 minutes.\"); // router.post('/login', loginRateLimiter, authController.login); errorHandler(err, req, res, next) Express error handling middleware. It catches errors passed by `next(err)` and sends a standardized JSON response. Parameters: Name Type Description err Error | ApiError The error object. req Express.Request Express request object. res Express.Response Express response object. next Express.NextFunction Express next middleware function. &lt;async&gt; getCurrentUser(req, res) Retrieves the profile of the currently authenticated user. Populates referral code information. Parameters: Name Type Description req Express.Request Express request object, req.user should be populated by Passport. res Express.Response Express response object. &lt;async&gt; handleOAuthFailure(req, res) Handles OAuth authentication failure. Redirects user to the frontend login page with an error. Parameters: Name Type Description req Express.Request Express request object. res Express.Response Express response object. &lt;async&gt; handleOAuthSuccess(req, res) Handles successful OAuth authentication. Redirects user to the frontend dashboard. The actual user creation/login is handled by the Passport strategy. This controller function is called *after* Passport successfully authenticates and establishes a session. Parameters: Name Type Description req Express.Request Express request object. res Express.Response Express response object. &lt;async&gt; handleStripeWebhook(req, res) Handles incoming Stripe webhook events. This endpoint is public and should not have authentication middleware. Parameters: Name Type Description req Express.Request Express request object. res Express.Response Express response object. isAuthenticated(req, res, next) Middleware to check if the user is authenticated via session. If authenticated, proceeds to the next handler. Otherwise, sends a 401 Unauthorized error. Relies on `passport.session()` middleware being set up. Parameters: Name Type Description req Express.Request Express request object. res Express.Response Express response object. next Express.NextFunction Express next middleware function. &lt;async&gt; logoutUser(req, res, next) Logs out the currently authenticated user. Destroys the session and clears the session cookie. Parameters: Name Type Description req Express.Request Express request object. res Express.Response Express response object. next Express.NextFunction Express next middleware function. &lt;async&gt; manageSubscriptionPortal(req, res) Creates a Stripe Customer Portal session for users to manage their subscription. Parameters: Name Type Description req Express.Request Express request object. res Express.Response Express response object. &lt;async&gt; upgradeToYearly(req, res) Allows a user to upgrade their existing Monthly subscription to a Yearly subscription. This updates the existing Stripe subscription. Parameters: Name Type Description req Express.Request Express request object. res Express.Response Express response object. validate(schema [, dataSource]) Middleware to validate request data (body, query, params) against a Joi schema. Parameters: Name Type Argument Default Description schema Joi.Schema The Joi schema to validate against. dataSource 'body' | 'query' | 'params' &lt;optional&gt; 'body' The part of the request object to validate. Returns: Express middleware function. Type function Example // In your route: // import { validate } from '../middlewares/validator.middleware.js'; // import { someSchema } from '../validators/some.validator.js'; // router.post('/some-endpoint', validate(someSchema), someController.handler); // router.get('/another-endpoint', validate(anotherSchema, 'query'), anotherController.handler); Type Definitions Plan Type: object Properties: Name Type Argument Description name string The name of the plan (e.g., \"Monthly Pro\", \"Yearly Business\"). type string The type of the plan (e.g., 'Monthly', 'Yearly'). Must be one of PlanTypes. price number The price of the plan in the smallest currency unit (e.g., cents for USD). 1000 for $10.00. currency string The currency of the price (e.g., 'usd', 'eur'). Defaults to 'usd'. stripePriceId string The ID of the corresponding price object in Stripe. This is crucial for Stripe integration. features Array.&lt;string&gt; &lt;optional&gt; An array of strings describing the features of the plan. description string &lt;optional&gt; A brief description of the plan. isActive boolean Whether the plan is currently active and available for new subscriptions. Defaults to true. createdAt Date Timestamp of when the plan was created. updatedAt Date Timestamp of when the plan was last updated. Referral Type: object Properties: Name Type Description userId mongoose.Schema.Types.ObjectId The user to whom this referral code belongs. referralCode string The unique referral code. numberOfReferrals number The count of users who have successfully used this referral code. createdAt Date Timestamp of when the referral entry was created. updatedAt Date Timestamp of when the referral entry was last updated. User Type: object Properties: Name Type Argument Description email string User's email address (unique). name string User's full name. avatar string &lt;optional&gt; URL to the user's avatar image. provider string The OAuth provider used for login (e.g., 'google', 'github', 'microsoft'). providerId string The unique ID of the user from the OAuth provider. referredBy mongoose.Schema.Types.ObjectId &lt;optional&gt; The User ID of the person who referred this user. referralDetails mongoose.Schema.Types.ObjectId &lt;optional&gt; Reference to this user's own referral record in the Referral collection. stripeCustomerId string &lt;optional&gt; Stripe customer ID for this user. stripeSubscriptionId string &lt;optional&gt; Stripe subscription ID for the current active subscription. subscriptionStatus string &lt;optional&gt; Status of the user's subscription (e.g., 'active', 'trialing', 'past_due', 'canceled', 'inactive'). currentPlanId mongoose.Schema.Types.ObjectId &lt;optional&gt; Reference to the Plan collection for the user's current active plan. currentPlanType string &lt;optional&gt; Type of the current plan ('Monthly', 'Yearly', 'FreeTrial'). Useful for quick checks. subscriptionExpiresAt Date &lt;optional&gt; Date when the current subscription or trial period expires. isFreeTrialEligible boolean &lt;optional&gt; Flag indicating if the user is still eligible for a free trial. Defaults to true. hasUsedFreeTrial boolean &lt;optional&gt; Flag indicating if the user has already used their free trial. Defaults to false. lastLoginAt Date &lt;optional&gt; Timestamp of the user's last login. refreshToken string &lt;optional&gt; JWT refresh token (if implementing JWT for session management alongside OAuth). createdAt Date Timestamp of when the user was created. updatedAt Date Timestamp of when the user was last updated. × Search results Close Documentation generated by JSDoc 4.0.4 on 2025-05-31T21:48:17+02:00 using the DocStrap template. "},"classes.list.html":{"id":"classes.list.html","title":"Classes","body":" My Backend API Docs Classes ApiErrorApiResponse Global STRIPE_PLAN_PRICE_IDSSTRIPE_WEBHOOK_SECRETasyncHandlerconnectDBcreateCheckoutSessioncreateRateLimitererrorHandlergetCurrentUserhandleOAuthFailurehandleOAuthSuccesshandleStripeWebhookisAuthenticatedlogoutUsermanageSubscriptionPortalrateLimiterstripeupgradeToYearlyvalidatevalidatePlanIdSchemavalidateReferralCodeSchema Classes Classes ApiError ApiResponse Members &lt;constant&gt; STRIPE_PLAN_PRICE_IDS :object Stores the Stripe Price IDs for monthly and yearly plans. These IDs must be created in your Stripe Dashboard. Type: object &lt;constant&gt; STRIPE_WEBHOOK_SECRET :string Webhook signing secret for verifying Stripe webhook events. Type: string &lt;constant&gt; rateLimiter General purpose rate limiter for all API routes. It limits each IP to `maxRequests` requests per `windowMs`. See: https://www.npmjs.com/package/express-rate-limit for more configuration options. &lt;constant&gt; stripe :Stripe Stripe API client instance. Type: Stripe &lt;constant&gt; validatePlanIdSchema Joi schema for validating a MongoDB ObjectId as a planId. &lt;constant&gt; validateReferralCodeSchema Joi schema for validating a referral code input. This might be used if a user can manually enter a referral code post-signup or during. Methods asyncHandler(requestHandler) Wraps an asynchronous request handler function to automatically catch errors and pass them to the next error-handling middleware. Parameters: Name Type Description requestHandler function The asynchronous route handler function. Returns: A new function that handles promise resolution and rejection. Type function Example import { asyncHandler } from \"../utils/asyncHandler.js\"; router.get(\"/some-route\", asyncHandler(async (req, res, next) =&gt; { // Your async logic here const data = await someAsyncOperation(); res.status(200).json(new ApiResponse(200, data, \"Data fetched\")); })); &lt;async&gt; connectDB() Establishes a connection to the MongoDB database. It uses the MONGODB_URI from environment variables and specifies the database name. Exits the process with failure code 1 if connection fails. Returns: A promise that resolves when the connection is successful. Type Promise.&lt;void&gt; &lt;async&gt; createCheckoutSession(req, res, next) Creates a Stripe Checkout Session for a new subscription. Parameters: Name Type Description req Express.Request Express request object. res Express.Response Express response object. next Express.NextFunction Express next middleware function. createRateLimiter(customWindowMs, customMaxRequests [, customMessage]) Creates a custom rate limiter with specific options. This allows for different rate limits on different routes if needed. Parameters: Name Type Argument Default Description customWindowMs number The time window in milliseconds. customMaxRequests number The maximum number of requests allowed in the window. customMessage string &lt;optional&gt; \"Too many requests, please try again later.\" Custom message for rate-limited responses. Returns: Express rate limit middleware instance. Type function Example // In your route file: // import { createRateLimiter } from '../middlewares/rateLimiter.middleware.js'; // const loginRateLimiter = createRateLimiter(5 * 60 * 1000, 5, \"Too many login attempts. Please try again in 5 minutes.\"); // router.post('/login', loginRateLimiter, authController.login); errorHandler(err, req, res, next) Express error handling middleware. It catches errors passed by `next(err)` and sends a standardized JSON response. Parameters: Name Type Description err Error | ApiError The error object. req Express.Request Express request object. res Express.Response Express response object. next Express.NextFunction Express next middleware function. &lt;async&gt; getCurrentUser(req, res) Retrieves the profile of the currently authenticated user. Populates referral code information. Parameters: Name Type Description req Express.Request Express request object, req.user should be populated by Passport. res Express.Response Express response object. &lt;async&gt; handleOAuthFailure(req, res) Handles OAuth authentication failure. Redirects user to the frontend login page with an error. Parameters: Name Type Description req Express.Request Express request object. res Express.Response Express response object. &lt;async&gt; handleOAuthSuccess(req, res) Handles successful OAuth authentication. Redirects user to the frontend dashboard. The actual user creation/login is handled by the Passport strategy. This controller function is called *after* Passport successfully authenticates and establishes a session. Parameters: Name Type Description req Express.Request Express request object. res Express.Response Express response object. &lt;async&gt; handleStripeWebhook(req, res) Handles incoming Stripe webhook events. This endpoint is public and should not have authentication middleware. Parameters: Name Type Description req Express.Request Express request object. res Express.Response Express response object. isAuthenticated(req, res, next) Middleware to check if the user is authenticated via session. If authenticated, proceeds to the next handler. Otherwise, sends a 401 Unauthorized error. Relies on `passport.session()` middleware being set up. Parameters: Name Type Description req Express.Request Express request object. res Express.Response Express response object. next Express.NextFunction Express next middleware function. &lt;async&gt; logoutUser(req, res, next) Logs out the currently authenticated user. Destroys the session and clears the session cookie. Parameters: Name Type Description req Express.Request Express request object. res Express.Response Express response object. next Express.NextFunction Express next middleware function. &lt;async&gt; manageSubscriptionPortal(req, res) Creates a Stripe Customer Portal session for users to manage their subscription. Parameters: Name Type Description req Express.Request Express request object. res Express.Response Express response object. &lt;async&gt; upgradeToYearly(req, res) Allows a user to upgrade their existing Monthly subscription to a Yearly subscription. This updates the existing Stripe subscription. Parameters: Name Type Description req Express.Request Express request object. res Express.Response Express response object. validate(schema [, dataSource]) Middleware to validate request data (body, query, params) against a Joi schema. Parameters: Name Type Argument Default Description schema Joi.Schema The Joi schema to validate against. dataSource 'body' | 'query' | 'params' &lt;optional&gt; 'body' The part of the request object to validate. Returns: Express middleware function. Type function Example // In your route: // import { validate } from '../middlewares/validator.middleware.js'; // import { someSchema } from '../validators/some.validator.js'; // router.post('/some-endpoint', validate(someSchema), someController.handler); // router.get('/another-endpoint', validate(anotherSchema, 'query'), anotherController.handler); Type Definitions Plan Type: object Properties: Name Type Argument Description name string The name of the plan (e.g., \"Monthly Pro\", \"Yearly Business\"). type string The type of the plan (e.g., 'Monthly', 'Yearly'). Must be one of PlanTypes. price number The price of the plan in the smallest currency unit (e.g., cents for USD). 1000 for $10.00. currency string The currency of the price (e.g., 'usd', 'eur'). Defaults to 'usd'. stripePriceId string The ID of the corresponding price object in Stripe. This is crucial for Stripe integration. features Array.&lt;string&gt; &lt;optional&gt; An array of strings describing the features of the plan. description string &lt;optional&gt; A brief description of the plan. isActive boolean Whether the plan is currently active and available for new subscriptions. Defaults to true. createdAt Date Timestamp of when the plan was created. updatedAt Date Timestamp of when the plan was last updated. Referral Type: object Properties: Name Type Description userId mongoose.Schema.Types.ObjectId The user to whom this referral code belongs. referralCode string The unique referral code. numberOfReferrals number The count of users who have successfully used this referral code. createdAt Date Timestamp of when the referral entry was created. updatedAt Date Timestamp of when the referral entry was last updated. User Type: object Properties: Name Type Argument Description email string User's email address (unique). name string User's full name. avatar string &lt;optional&gt; URL to the user's avatar image. provider string The OAuth provider used for login (e.g., 'google', 'github', 'microsoft'). providerId string The unique ID of the user from the OAuth provider. referredBy mongoose.Schema.Types.ObjectId &lt;optional&gt; The User ID of the person who referred this user. referralDetails mongoose.Schema.Types.ObjectId &lt;optional&gt; Reference to this user's own referral record in the Referral collection. stripeCustomerId string &lt;optional&gt; Stripe customer ID for this user. stripeSubscriptionId string &lt;optional&gt; Stripe subscription ID for the current active subscription. subscriptionStatus string &lt;optional&gt; Status of the user's subscription (e.g., 'active', 'trialing', 'past_due', 'canceled', 'inactive'). currentPlanId mongoose.Schema.Types.ObjectId &lt;optional&gt; Reference to the Plan collection for the user's current active plan. currentPlanType string &lt;optional&gt; Type of the current plan ('Monthly', 'Yearly', 'FreeTrial'). Useful for quick checks. subscriptionExpiresAt Date &lt;optional&gt; Date when the current subscription or trial period expires. isFreeTrialEligible boolean &lt;optional&gt; Flag indicating if the user is still eligible for a free trial. Defaults to true. hasUsedFreeTrial boolean &lt;optional&gt; Flag indicating if the user has already used their free trial. Defaults to false. lastLoginAt Date &lt;optional&gt; Timestamp of the user's last login. refreshToken string &lt;optional&gt; JWT refresh token (if implementing JWT for session management alongside OAuth). createdAt Date Timestamp of when the user was created. updatedAt Date Timestamp of when the user was last updated. × Search results Close Documentation generated by JSDoc 4.0.4 on 2025-05-31T21:48:17+02:00 using the DocStrap template. "},"index.html":{"id":"index.html","title":"Index","body":" My Backend API Docs Classes ApiErrorApiResponse Global STRIPE_PLAN_PRICE_IDSSTRIPE_WEBHOOK_SECRETasyncHandlerconnectDBcreateCheckoutSessioncreateRateLimitererrorHandlergetCurrentUserhandleOAuthFailurehandleOAuthSuccesshandleStripeWebhookisAuthenticatedlogoutUsermanageSubscriptionPortalrateLimiterstripeupgradeToYearlyvalidatevalidatePlanIdSchemavalidateReferralCodeSchema Index app.js Main application file for the Express server. Author: Your Name Index bridge.js Utility to determine environment-specific configurations. Author: Your Name Index config/db.js MongoDB connection setup. Author: Your Name Index config/passport-setup.js Passport.js authentication strategies setup. Author: Your Name Index config/stripe.js Stripe API initialization and constants for plan price IDs. Author: Your Name Index config/swagger.js Configuration for Swagger API documentation using JSDoc comments. Author: Your Name Index constants/index.js Application-wide constants. Author: Your Name Index controllers/auth.controller.js Authentication controller for handling OAuth callbacks, logout, and user profile. Author: Your Name Index controllers/payment.controller.js Controller for Stripe payment operations and webhook handling. Author: Your Name Index middlewares/auth.middleware.js Authentication middleware to protect routes. Author: Your Name Index middlewares/errorHandler.middleware.js Global error handling middleware for Express. Author: Your Name Index middlewares/rateLimiter.middleware.js Rate limiting middleware using express-rate-limit. Author: Your Name Index middlewares/validator.middleware.js Joi validation middleware. Author: Your Name Index models/plan.model.js Defines the Mongoose schema for Plans. Author: Your Name Index models/referral.model.js Defines the Mongoose schema for Referrals. Author: Your Name Index models/user.model.js Defines the Mongoose schema for Users. Author: Your Name Index routes/auth.routes.js Authentication routes for OAuth login, logout, and user profile. Author: Your Name Index routes/index.routes.js Main router for API v1. Aggregates all other route modules. Author: Your Name Index routes/payment.routes.js Payment-related API routes for Stripe integration. Author: Your Name Index utils/ApiError.js Custom Error class for API errors. Author: Your Name Index utils/ApiResponse.js Class for standardizing API responses. Author: Your Name Index utils/asyncHandler.js Utility to handle asynchronous route handlers and catch errors. Author: Your Name Index validators/auth.validator.js Joi validation schemas for authentication-related inputs. Author: Your Name Index validators/payment.validator.js Joi validation schemas for payment-related inputs. Author: Your Name × Search results Close Documentation generated by JSDoc 4.0.4 on 2025-05-31T21:48:17+02:00 using the DocStrap template. "},"ApiError.html":{"id":"ApiError.html","title":"Class: ApiError","body":" My Backend API Docs Classes ApiErrorApiResponse Global STRIPE_PLAN_PRICE_IDSSTRIPE_WEBHOOK_SECRETasyncHandlerconnectDBcreateCheckoutSessioncreateRateLimitererrorHandlergetCurrentUserhandleOAuthFailurehandleOAuthSuccesshandleStripeWebhookisAuthenticatedlogoutUsermanageSubscriptionPortalrateLimiterstripeupgradeToYearlyvalidatevalidatePlanIdSchemavalidateReferralCodeSchema Class: ApiError ApiError new ApiError(statusCode, message, errors, stack) Represents an API error with a status code, message, and optional details. Parameters: Name Type Description statusCode number HTTP status code for the error. message string Error message. errors Array Optional array of detailed error messages or objects. stack string Optional error stack trace. Extends Error × Search results Close Documentation generated by JSDoc 4.0.4 on 2025-05-31T21:48:17+02:00 using the DocStrap template. "},"ApiResponse.html":{"id":"ApiResponse.html","title":"Class: ApiResponse","body":" My Backend API Docs Classes ApiErrorApiResponse Global STRIPE_PLAN_PRICE_IDSSTRIPE_WEBHOOK_SECRETasyncHandlerconnectDBcreateCheckoutSessioncreateRateLimitererrorHandlergetCurrentUserhandleOAuthFailurehandleOAuthSuccesshandleStripeWebhookisAuthenticatedlogoutUsermanageSubscriptionPortalrateLimiterstripeupgradeToYearlyvalidatevalidatePlanIdSchemavalidateReferralCodeSchema Class: ApiResponse ApiResponse new ApiResponse(statusCode, data, message) Represents a standardized API response. Parameters: Name Type Description statusCode number HTTP status code for the response. data * Data payload of the response. message string Response message, defaults to \"Success\". × Search results Close Documentation generated by JSDoc 4.0.4 on 2025-05-31T21:48:17+02:00 using the DocStrap template. "}}
    </script>

    <script type="text/javascript">
        $(document).ready(function() {
            Searcher.init();
        });

        $(window).on("message", function(msg) {
            var msgData = msg.originalEvent.data;

            if (msgData.msgid != "docstrap.quicksearch.start") {
                return;
            }

            var results = Searcher.search(msgData.searchTerms);

            window.parent.postMessage({"results": results, "msgid": "docstrap.quicksearch.done"}, "*");
        });
    </script>
</body>
</html>
